# 第 2 章 创建和使用数据库

### 缺失的字句

某些数据库，比如 Oracle，规定查询语句中必须包含 from 字句，并至少指明一个表名。在 Oracle 中有一个特殊表 **dual**，只含有一个列 dummy，只有一个数据行，当查询语句不需要查表时，from 字句可以指向这个表。为了与 Oracle 兼容， MySQL 也有 dual 表

## 2.3 MySQL 数据类型

### 字符型

**定长**字符型 char，最大长度 255 字节；**变长**字符型 varchar，最大长度 65535 字节（Oracle 为 varchar2）

#### 字符集

拉丁系语言，每个字母只需要一个字节来存储，为**单字符集**；中日韩语等，每个字符需要多个字节来存储，为**多字符集**  

查看支持的字符集：  
`SHOW CHARACTER SET;`

### 文本

若数据超过 64KB(varchar 上限)，就需要文本类型  
| 类型       | 长度       |
| ---------- | ---------- |
| tinytext   | 255        |
| text       | 65535      |
| mediumtext | 16777215   |
| longtext   | 4294967295 |

* 如果数据超过该类型最大长度，数据会被截断
* 向文本列装载数据时，不会消除尾部空格
* 使用文本列排序或分组时，默认只会使用前 1024 个字节
* SQL Server 只有 text，DB2 和 Oracle 则是 clob(Character Large Object)
* 现在 varchar 最大 65535 字节，一般不需要使用 tinytext 和 text

### 数值型

整数(前面可加上 unsigned 表示无符号)：  
| 类型      | 带符号范围                               | 无符号范围             |
| --------- | ---------------------------------------- | ---------------------- |
| tinyint   | -128~127                                 | 0~255                  |
| smallint  | -32768~32767                             | 0~65535                |
| mediumint | -8388608~8388607                         | 0~16777215             |
| int       | -2147483648~2147483647                   | 0~4294967295           |
| bigint    | -9223372036854775808~9223372036854775807 | 0~18446744073709551615 |

浮点数：
| 类型        | 范围                                                                                                      |
| ----------- | --------------------------------------------------------------------------------------------------------- |
| float(p,s)  | -3.402823466E+38 ~ -1.175494351E-38<br/>1.175494351E-38 ~ 3.402823466E+38                                 |
| double(p,s) | -1.7976931348623157E+308 ~ -2.2250738585072014E-308<br/>2.2250738585072014E-308 ~ 1.7976931348623157E+308 |

浮点数可指定其精度：float(总位数, 小数位数)，但不是必须的，指定后，过长的小数位会被四舍五入；同样可以定义为 unsigned，但只是不能存放负数，不会扩大范围

### 时间

| 类型      | 默认格式            | 范围                                    |
| --------- | ------------------- | --------------------------------------- |
| date      | YYYY-MM-DD          | 1000-01-01~9999-12-31                   |
| datetime  | YYYY-MM-DD HH:MI:SS | 1000-01-01 00:00:00~9999-12-31 23:59:59 |
| timestamp | YYYY-MM-DD HH:MI:SS | 1970-01-01 00:00:00~2037-12-31 23:59:59 |
| year      | YYYY                | 1901~2155                               |
| time      | HHH:MI:SS           | -838:59:59~838:59:59                    |

## 2.4 表的创建

```sql
CREATE TABLE tablename( 
    colname TYPE, 
    ... ,
    CONSTRAINT pkname PRIMARY KEY (colname) -- 定义主键约束
);
```

还可以定义检查约束，限制字段能存储的值，如：
```sql
    gender CHAR(1) CHECK(gender IN('M', 'F'))

    -- 也可以使用 Mysql 的枚举类型达到类似效果
    gender ENUM('M', 'F')
```