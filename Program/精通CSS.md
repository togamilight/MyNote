# 第二章 为样式找到应用目标

## 2.1 常用的选择器

`tagName` 标签选择器， `.class` 类选择器，`#id` id选择器， `parent child` 后代选择器

### 伪类

* `:link :visited` 称为**链接伪类**，只能用于锚元素。
* `:hover :active :focus` 称为**动态伪类**，理论上可用于任何元素。

## 2.3 高级选择器

`parent>child` 子选择器，`h2+p` 其后相邻同胞选择器（IE7以上都支持，但在IE7中，父子元素之间有HTML注释会出问题）
* 在不兼容的浏览器中，可以使用以下方法实现相同效果
    ```CSS
    /*先将样式应用到所有后代元素，再将非直接子元素的样式还原*/
    #nav li { /*想实现在子元素上的效果*/ }
    #nav li * { /*还原非直接子元素的样式*/ }
    ```

`[attr="value"]`属性选择器
* 属性选择器的几种形态：
    * `[attribute]`：根据属性名选择
    * `[attribute='value']`：根据属性值选择
    * `[attribute~='value']`：根据属性值之一选择
    * `[attribute|='value']`：选择属性值以value开头的属性的元素（value或value-*）
    * `[attribute^='value']`：选择属性值以value开头的属性的元素
    * `[attribute$='value']`：选择属性值以value结尾的属性的元素

### 层叠和特殊性（优先级）

层叠采用以下重要度次序：
* 标有 `!important` 的用户样式
* 标有 `!important` 的作者样式
* 作者样式
* 用户样式
* 浏览器/用户代理应用的样式

然后根据选择器的特殊性来决定优先度，优先度相同的以后定义的规则优先。
特殊性分为4个等级：a、b、c、d
* **行内样式：** a = 1（1000）
* **id选择器：** b = 数量（X * 100）
* **类、伪类、属性选择器：** c = 数量（X * 10）
* **类型（标签）、伪元素选择器：** d = 数量（X * 1）

**Tip：** 在body标签上添加id或类，使用特殊性来灵活控制站点的设计与布局

### 继承

后代元素会继承其父元素的某些属性，比如字体、颜色，且继承的样式的特殊性为空，直接应用于元素的样式会覆盖继承的样式。

## 2.4 规划、组织和维护样式表

### 对文档应用样式

对HTML应用CSS有几种方法（其中的`type`属性都是可省略的）：
1. 使用`style`标签，在其中直接书写CSS样式
    ```HTML
    <style type="text/css">
        ...
    </style>
    ```
2. 外部CSS文件，使用`link`标签导入
    ```HTML
    <link href="/css/basic.css" rel="stylesheet" type="text/css" />
    ```
3. 在CSS代码（`style`标签中或CSS文件中）中使用`@import`导入外部CSS文件
    ```HTML
    <style type="text/css">
        @import url("/css/basic.css");  /*双引号加不加无所谓*/
    </style>
    ```
`import`要比`link`慢

把CSS文件分成多个会影响速度，且浏览器从同一域能下载的文件数量有限，老式浏览器通常是2个，现代浏览器8个（查了资料，这里应该指的是浏览器**最大并发请求资源数**，即同一域名下同一时间能请求的资源数量）。推荐使用单一CSS文件，还便于维护。

### 代码结构
通常把最一般的样式放在最前面，越特殊的放在越后面，比如以下结构：
* 一般性样式
    * body样式
    * reset样式（重写标签的默认样式，可以统一不同浏览器间的标签样式）
    * a、h及其它标签的样式
* 辅助样式
    * 表单
    * 通知和错误
    * 一致的条目
* 页面结构
    * 标题、页脚和导航
    * 布局
    * 其它页面结构元素
* 页面组件
    * 各个页面
* 覆盖

可以使用统一风格的注释块来分割各个部分。

### 自我提示
在注释中，用某些关键字来标注，比如`@todo:`、`@bugfix:`、`@workaoround:`（并不完善的权宜之计）等，可以参考CSSDoc项目（http://cssdoc.net），这个项目的目的是为样式表开发一套标准的注释语法。

不过注释太多也会增加CSS文件的体积，可以采用服务器端压缩的方式，删除注释和空格，打包成GZIP格式，所有现代浏览器都可以处理用GZIP压缩的文件并即时解压。

# 第三章 可视化格式模型

## 3.1 盒模型概述

盒模型结构：`content - padding - border - margin - outline(不占用空间)`
盒模型的 `width` 和 `height` 指的是 `content` 的宽和高，可以通过 `box-sizing: border-box`（默认值是 `content-box`）将其设为 `content + padding + border` 的大小。
在IE的早期版本，包括IE6中，使用的就是`border-box`的盒模型。

### 外边距叠加

外边距叠加是指：在**垂直**方向上，两个或多个 `margin` 相邻时，会产生叠加，只留下最高的 `margin`。
具体情况包括：
* 两元素相叠，第一个元素的 `margin-bottom` 与第二个元素的 `margin-top` 叠加
* 一个元素包含另一个元素，如果没有 `padding` 或 `border` 将 `margin` 分隔开，它们的 `margin-top/bottom` 也会叠加，此时会表现为父元素与子元素的上/下边紧贴在一起，而父元素出现外边距
* 一个元素本身的 `margin-top/bottom`，若没有 `content, padding, border` 的分隔，也会叠加

只有**标准文档流**中的**块框**才会发生外边距叠加。**行内框、浮动框或绝对定位框**则不会。

## 3.2 定位概述

### 可视化格式模型

HTML元素主要分为**块级元素**和**行级元素**，可以用 `display` 属性来改变。CSS中有3种基本定位机制：**标准文档流、浮动和绝对定位**。除非专门指定，否则所有框都位于**标准文档流**中：**块级框**垂直排列；**行内框**在一行中水平排列，且只能调整**水平方向**的 `margin, padding, border`，垂直方向的无效，**高度、宽度**也无效，只可以通过 `line-height` 来调节一行的**行高**。`display: inline-block` 可以使元素在行内排列同时还可以像块级元素一样设置宽高以及垂直方向边距。

**匿名块、行框：** 在块元素开头的裸露文本，会自动被当成一个块元素对待，称为**匿名块框**(**!这说法存疑，经测试，并没有发现块级元素开头的文本表现出块框的特性**)。块级元素内的文本行则会被当成**匿名行框**，如包含3行文本的段落，每行文本形成一个匿名行框。匿名框一般来说无法直接应用样式，除非用 `:first-line` 伪元素。可知，**屏幕上看到的所有东西都形成某种框**

### 相对定位 (relative)

相对定位元素相对于其原本的位置进行偏移，不过它实际占用的空间仍是它原本的位置（仍是标准文档流的一部分），所以相对定位元素看起来会覆盖其它框

### 绝对定位 (absolute)

绝对定位元素与标准文档流无关，因此不占据空间，其位置是相对于**最近的已定位祖先元素**来确定的，如果没有已定位的祖先元素，则相对于**初始包含块**来确定。

### 固定定位 (fixed)

**固定定位**是**绝对定位**的一种，差异是**固定定位**的包含块是 `viewport`，所以固定定位元素总会出现在窗口的相同位置。（IE6及以下不支持固定定位，IE7部分支持，但有许多bug！）

### 浮动 (float)

浮动框向左或向右移动，直到它的外边缘碰到包含框或另一个浮动框的边缘(经测试，只有左右，上边缘会被在其之前的**块级元素**挡住)，浮动框同样不属于标准文档流。浮动框就像在水中的浮体一样，拼命向上，容器的宽度不够时就浮在第二行，浮块大小不一还会被卡住。。。

#### 行框和clear

**浮动框**虽然说不会影响其他框，但实际上，它会挤掉**行内框**，展现出文字围绕**浮动框**排列的效果。
**清除浮动：** 使用`clear：left/right/both`，对应左/右/两种浮动，应用了该属性的**块级元素**，将会消除其之前的浮动元素对其本身及其后元素的影响（或者说 消除其本身及其后元素的浮动，除非对它们应用`float`?）；清除浮动还能使浮动元素的父容器能感知到浮动元素的大小，从而适应其大小（另一种方法是为父容器也添加浮动）。此外，设置了 `overflow：hidden/auto` 的元素，将清除其包含的所有元素的浮动，或者使用 `:after` 伪元素来添加 `clear`

# 第四章 背景图像效果

## 4.1 背景图像基础

使用 `background` 属性可为元素添加背景图像。
* **垂直渐变色背景的技巧：** 可以使用一张细长的渐变色背景，将其横向平铺(`background-repeat: repeat-x`)，然后再添加一个和渐变后的颜色相同的**背景颜色**，**背景图案**总是在**背景颜色**上面，这样，当网页很长时，也能保证一直有背景色存在
* **用背景图像做纯图案：** 可以创建一个空的 `div`,用CSS为其设置背景图像
* **使用背景图像作为图标：** 有时会想要在每个条目前显示一个图标，可以为该元素添加 `padding` 留出空间，然后在该处显示背景图像作为图标，如：
    ```CSS
    h1{
        padding-left: 30px;
        background: url(/img/xx.png) no-repeat left center;
    }
    ```

* **图像位置 `background-position`** ：可以设定**两**个值，分别表示**水平**和**垂直**方向的距离。
    * **数值：** 当为长度单位数值时，设置图案左上角的点与元素左边和上边的距离；若为百分比，则为该图案的该百分比处的点与元素左边和上边的百分比距离，比如，设置 `50%` 则背景图像完全居中。百分比与长度单位数值计算公式：positionX|Y = (容器宽|高 - 图片宽|高) * 百分比。 
    * **关键字：** `left, right, center, top, bottom`
    
    如果只设定一个值，则默认为**水平**方向距离，**垂直**方向默认为**50%** 。**数值与关键字**可以混合使用，此时，`left/right` 和 `top/bottom` 分别只能指定**水平**（第一个）和**垂直**（第二个）方向的值；当一个**数值**与一个**关键字**时，仍然分别代表**水平**和**垂直**方向的值，也可以用一个**关键字**和一个**数值**来指定一个方向，如`right 10px bottom 20px`，表示图片右边距离容器右边10px，图片下边距容器下边20px。混用在某些浏览器上会出错，不建议使用。

## 4.2 圆角框

思路主要是将圆角背景图片分为多块，放在不同的div中，拼成一整块；或者设置背景颜色，并在四角使用白色图片蒙板盖住尖角变成圆角（山顶角法）。

### 多个背景图片

在CSS3中允许指定多个背景图片，用逗号隔开，如下：

```CSS
.box{
    background-image: url(ww), url(xx), url(yy), url(zz);
    background-repeat: no-repeat, no-repeat, no-repeat, no-repeat;
    background-position: left top, right top, left bottom, right bottom;
}
```

### `border-radius`

使用 `border-raius` 可以很方便地设置圆角边框，别整那么多虚的

### `border-image`

这个属性可以指定一个图像作为边框，采用九分法缩放（nine-slice scaling）技术，就是把图片分为九个部分，类似九宫格，内容放在最中间，其它是边界，这样，不管怎样缩放，四角都不会失真，而其它部分是长方体，纯色的话，拉伸同样不会失真。切割的比例要自己指定。在chrome中，需要先设置 `border` 才会生效，可以设为透明的，比如 `border: 1px solid transparent;`; 如果加前缀，则可直接生效，如`-webkit-`

## 4.3 投影

### `box-shadow`

指定四个值就可以设置盒子阴影：水平偏移，垂直偏移，模糊半径，[阴影扩展半径，] 颜色

## 4.4 不透明度

### `opacity`

CSS的 `opacity` 属性可以设置不透明度(0~1)。其主要问题是，元素的内容也会继承它，比如，元素内的文字也会变得透明。

### `rgba(r, g, b, a)`

其中的a参数用来设置不透明度(0~1)，通过给 `background-color` 设置rgba来设置元素的透明度

### PNG透明度

png图片是支持透明度的，但IE6不支持png图片，可以使用AlphaImageLoader或IE PNG Fix方法解决。

### CSS视差效果

本例中用两个背景透明的图案盖在网页背景上，并为这些背景设置不同的position百分比，这样，在改变窗口大小时由于position百分比不同，就会产生视差效果（什么鬼，我本以为是滚动时的视差效果）

## 4.5 图像替换文字

想给文字应用很独特的字体、排版等，又不想直接嵌入图片，导致搜索引擎无法读取它，在这种想法之下，产生了这种很别扭的技术，先加载文字，然后隐藏它并在该位置显示图片。弊端很多，仅做了解。

### FIR 

将文字放入span标签中，将替换图片作为背景图像应用于外层元素，再将span标签 `display: none`。
许多屏幕阅读器会忽略 `display:none | visibility: hidden` 的元素，造成严重的可访问性问题，不要使用它！

### Phark (Fuck?)

将文字应用非常大的负值文本缩进(`text-indent: -5000px`)，再将图片作为背景应用于容器。
和FIR一样，如果打开CSS而关闭图片，这些文字将不会被看到，对于重要信息或导航信息最好不要用这方法。

### sIFR

Flash允许将文字嵌入SWF文件，且这些文字是可选择的，所以可以用JS将文本替换为Flash文件。这种方法不为每个文本段创建单独的Flash文件，而是使用一个重复的Flash文件，所以只需要为容器添加一个class，剩下的用JS和Flash来解决。
这个方法加载时间较长，因为要用JS，要等待整个页面加载完成。反正也是没有，Flash都扑街了。

# 第五章 对链接应用样式

## 5.1 简单的链接样式

可以通过伪类来为 `a` 标签的不同状态设置样式（后三个大部分标签都适用，IE7以下伪类无法用于`a`以外的标签）：

* `:link`：未访问
* `:visited`：已访问
* `:hover`：鼠标悬浮
* `:focus`：被聚焦(通过键盘选择)
* `:active`：被点击

选择器的次序很重要，由于优先级都相等，顺序会导致覆盖，按以上排列顺序定义为好

## 5.4 为链接目标设置样式

`a` 标签可以在链接结尾使用 `#id` 的形式定位到页面某个元素处，可以通过 `:target` 伪类来为目标元素设置样式

## 5.5 突出显示不同类型的链接

使用CSS的属性选择器来实现，如外部链接：`a[href^="http"]`，下载文档：`a[href$=".doc"]`。IE6以下不支持属性选择器！

## 5.6 创建类似按钮的链接

给 `a` 标签应用 `display: block | inline-block`，并设置宽高和背景图案等来使其看起来像一个按钮。

但是，如果使用 `a` 标签作为表单的按钮，比如删除按钮，在谷歌的加速程序或搜索引擎的spider启动时，会访问这些 `a` 标签中的链接以便缓存它们，就会导致删除内容！所以绝不要使用链接更新服务器，即链接只使用GET请求而不使用POST请求。

### 按钮背景变换

指的是鼠标点击、悬浮等操作时，`a` 标签的背景产生变化，增强交互性。可以使用简单的颜色或者背景图片变换，或者将不同的背景拼在一张图片中，通过截取不同位置来获取不同背景，减少服务器请求数量，这种方法称为Pixy方法。不过，在IE中，这样仍会向服务器请求新的图像，必须添加以下CSS代码，启用背景缓存
```CSS
html{
    filter: expression(document.execCommand("BackgroundImageCache", false, true));
}
```
Pixy方法可以更进一步，将整个网页的图片全都拼成一张，有效减少图片的服务器请求。

# 第六章 对列表应用样式和创建导航条



## 6.1 基本列表样式

**定制项目符号：** 可以使用 `list-style-type, list-style-image` 来定制项目符号的类型、自定义图片，但是这样对图像位置的控制能力不强，更常用的是关闭项目符号，然后通过列表元素的背景图片来定制项目符号。

**IE**的早期版本和**Opera**用**左外边距**控制列表缩进，而大多数现代浏览器则使用**左内边距**。因此需要先将列表的**外边距和内边距**都置0，去掉这个缩进，还要去掉默认项目符号。

然后为列表项添加**左内边距**，将项目符号作为背景图像应用于**列表项**。如果列表项跨多行，可以将符号放在接近列表项顶部的位置，否则就将垂直位置设置成**middle或50%**，使其居中：

```CSS
ul{
    margin: 0;
    padding: 0;
    list-style-type:none;
}

li{
    background: url(xx.png) no-repeat 0 50%;
    padding-left: 30px;
}
```

列表项为`display:list-item`，是一个特殊的块框，前面带有项目符号。

## 6.7 简单的下拉菜单

将子导航的列表嵌套进主导航的列表中，使用绝对定位，并将其定位与屏幕外使其隐藏，比如 `position: absolute; left: -999em;`，需要使其显示时再恢复其定位即可：`left: auto`；

## 6.10 定义列表

除了有序列表 `ol` 和无序列表 `ul`外，还有一种定义列表 `dl`，包含定义术语 `dt` 和一或多个定义描述 `dd`，例子：

```html
<dl>
    <dt>Apple</dt>
    	<dd>Fruit</dd>
    	<dd>Red Or Green</dd>
    <dt>Banana</dt>
    	<dd>Fruit</dd>
    	<dd>Yellow</dd>
</dl>
```

# 第七章 对表单和数据表格应用样式

## 7.1 对数据表格应用样式

### 表格特有的元素

* `<caption>`：作为表格的标题，一个，可选
* `<thead>`：表头，一个，可选
* `<tfoot>`：表格的页脚，脚注，一个，可选
* `<tbody>`：表体，多个，可选，如果有表头或表脚，则必须至少有一个
* `<colgroup>,<col>`：在`<colgroup>`中用 `<col/>` 对一个或多个列定义和分组，以便对整列应用样式

### 表格样式

* `border-collapse`：定义边框样式
  * **collapse** ：相邻单元格共享边框
  * **seperate** ：每个单元格独立边框（默认）
* `border-spacing`：单元格边框间隔

## 7.2 简单的表单布局

### 有用的表单元素

* `<filedset>`：可以对信息块进行分组，可以用 `<legend>` 来为其添加标题，不过在不同浏览器中，`<legend>` 的样式不同，很难对其应用样式。
* `<label>`：用来描述每个表单元素的意义，点击`<label>`，可以使对应的表单元素获得焦点，使用 `<label>` 有两种方式：
    ```html
    <!-- 通常，将label变成块框使其独占一行，如果对于某些元素，
    比如单选按钮，想让其与label同行，就可以使用以下这种方法将其包含进来 -->
    <label>用户名 <input type="text"/></label>

    <label for="email">邮箱</label>
    <input type="text" id="email" />
    ```

## 7.3 复杂的表单布局

### 提交按钮
可以使用 `<button>` 代替 `<input>`。在`<button>` 中放置一个 `<img>` 可以以该图片为背景生成按钮

# 第八章 布局

## 8.3 基于浮动的布局

浮动布局的技巧是浮动几乎所有东西，然后在整个文档的“战略点”（比如页脚）处进行一两次清理，还可以用 `overflow: hidden`来清理某些元素的内容。

## 8.4 固定宽度、流式和弹性布局

### 固定宽度布局

固定宽度布局的特点是宽度多以像素为单位
* 优点：使开发人员对布局和定位有更大的控制能力，是最简便、最常用的布局方式
* 缺点：因为是固定的，所以无法随窗口大小变化改变尺寸，无法充分利用可用空间。另一个问题是关于行长和文本易读性，固定宽度的布局往往适合于浏览器默认文本字号，但只要增大文本字号，边栏就会挤满空间而且行长太短，不利阅读

### 流式布局

流式布局的尺寸用**百分数**来设置，使其能相对于浏览器窗口进行伸缩。
* 优点：高效利用空间，可适应浏览器窗口大小，用户体验好
* 缺点：当窗口宽度很小时，行变得很窄，不易阅读，应该适当设置 `min-width`, 且还不能设置太大，否则就跟固定宽度布局差不多了。如果窗口太宽也不行，所以宽度百分比要适当小一点，有时可以设置 `max-width`.

### 弹性布局

弹性布局相对于字号来设置尺寸。可以先将字号设为10px，更容易计算。还可以只设置最外层容器尺寸单位为em，内部仍为百分数，
* 优点：字号放大时整个布局随之扩大，可以将行长保持在适合阅读的范围，对于视力弱或有认知障碍的人尤其有用
* 缺点：弹性布局一些缺点和固定宽度布局相同。另外，增大字号导致整个布局变大，比浏览器窗口还大时会出现水平滚动条，可以设置容器 `max-width: 100%` 来避免这种情况
说了这么多，现在浏览器都有缩放功能了，这个基本没用了

### 流式和弹性布局中的图像

流式或弹性布局中，固定宽度的图像会严重影响设计。
* 减小布局宽度时，图片会相对它移动，产生负面影响；图像会以原始的最小宽度显示，阻止某些元素尺寸缩小；有些图像则会溢出父元素
* 增大布局宽度时，则会形成空隙过大、不平衡的设计。

#### 解决办法

* 对于跨越大区域的图像，可以使用背景图像而不是 `<img>`
* 如果需要用 `<img>`，可以把父元素的宽度设为 **100%** ，并且 `overflow: hidden`，这样，图像的右边会被截断，使其适合父元素，而不会随布局伸缩
* 对于希望伸缩的图像，可以设置图像的宽度为百分数，并添加与其原始宽度相同的 `max-width` 避免失真

## 8.5 faux列

    在布局完成后，由于背景都是白色的，并不能很好地将3列分开。为了有一个较好的“列”的效果，需要有不同颜色的背景来区分3列，同时，这个背景必须达到整个布局的最大高度，所以不好在各个内容区域中应用背景。fuax列的方式就是用一张自带3列颜色的图片（很短就好，`repeat-y`）作为布局容器的背景图像。
    在固定宽度布局中创建faux列十分简单。但是流式布局由于列的尺寸、位置随浏览器窗口缩放而变化，需要靠**百分比**来为背景图像定位。而且，流式布局的faux一次只能分为两列（通过水平方向的百分数为一列贴上背景，另一列为默认白色背景，正好两列），在多列的布局中，需要建多一些子容器。
    
## 8.6 等高的列



# Tip

### 神奇的`overflow: hidden`

* 若父元素的高度固定，`overflow: hidden` 可以用来隐藏子元素溢出
* 若父元素的高度为auto，`overflow: hidden` 可以为子元素清除浮动（使父元素能包住子元素）
* `overflow: hidden` 还可以使子元素与父元素不会产生外边距叠加

`overflow: hidden` 能清除浮动跟**BFC**有关：（https://www.jianshu.com/p/7e04ed3f4bea）

### BFC

BFC（Block Formatting Context），块级格式化上下文，它规定了内部的块级元素的布局方式，默认情况下只有根元素（即body）一个块级上下文。

1、BFC布局规则
* 内部的块级元素会在垂直方向，一个接一个地放置；
* 块级元素垂直方向的距离由margin决定。属于同一个BFC的两个相邻的块级元素会发生margin合并，不属于同一个BFC的两个相邻的块级元素不会发生margin合并；（**消除外边距叠加**）
* 每个元素的margin box的左边，与包含border box的左边相接触（对于从左往右的格式化，否则相反）。即使存在浮动也是如此；
* BFC的区域不会与float box重叠；（**可以用来清除子元素浮动**）
* BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素；外面的元素也不会影响到容器里面的子元素；
* 计算BFC的高度时，浮动元素也参与计算。

2、创建一个BFC
首先我们要知道怎样创建BFC。一个BFC可以被显式触发，只需满足以下条件之一：
* float的值不为none；
* overflow的值不为visible；
* position的值为fixed / absolute；
* display的值为table-cell / table-caption / inline-block / flex / inline-flex。
